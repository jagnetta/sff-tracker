<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Taunton Scouting for Food Drive</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-with-logos">
                <img src="images/scouting-for-food-logo.jpg" alt="Scouting for Food Logo" class="logo">
                <div class="header-text">
                    <h1>Taunton Scouting for Food Drive</h1>
                    <p>Please login to access the route selector</p>
                </div>
                <img src="images/scouting-for-food-logo.jpg" alt="Scouting for Food Logo" class="logo">
            </div>
        </header>

        <main>
            <div class="login-container">
                <h2>Login</h2>
                <form id="loginForm">
                    <div class="form-group">
                        <label for="username">Username:</label>
                        <input type="text" id="username" name="username" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="password">Password:</label>
                        <input type="password" id="password" name="password" required>
                    </div>
                    
                    <div id="errorMessage" class="error-message" style="display: none;"></div>
                    
                    <div style="display: flex; gap: 10px; align-items: center; justify-content: center; margin-top: 20px;">
                        <a href="user-guide.html" class="btn-help">Help</a>
                        <button type="submit" class="btn-primary">Login</button>
                    </div>
                </form>
            </div>
        </main>

        <div id="loginStats" class="login-stats">
            <div class="login-stats-header">
                <h3>Current Drive Status</h3>
            </div>
            <div class="login-stats-grid">
                <div class="login-stat">
                    <div class="stat-number" id="loginTotalRoutes">0</div>
                    <div class="stat-description">Assigned Routes</div>
                </div>
                <div class="login-stat">
                    <div class="stat-number" id="loginTotalTags">0</div>
                    <div class="stat-description">Assigned Tags</div>
                </div>
                <div class="login-stat">
                    <div class="stat-number" id="loginActiveUnits">0</div>
                    <div class="stat-description">Participating Units</div>
                </div>
                <div class="login-stat">
                    <div class="stat-number" id="loginAvailableRoutes">0</div>
                    <div class="stat-description">Available Routes</div>
                </div>
            </div>
        </div>

        <footer>
            <p style="text-align: center; margin-bottom: 5px;">Taunton Scouting for Food Drive</p>
            <p style="text-align: center; margin-top: 0;">scoutingforfoodtaunton.duckdns.org</p>
        </footer>
    </div>

    <script src="data.js"></script>
    <script src="route-tracker.js"></script>
    <script src="auth.js"></script>
    <script src="contextual-help.js"></script>
    <script>
        // Load and display statistics on login page
        document.addEventListener('DOMContentLoaded', function() {
            loadLoginStats();
        });

        function loadLoginStats() {
            // Compile all routes from all regions
            let allRoutesData = [];
            
            Object.keys(routeData).forEach(region => {
                routeData[region].forEach(route => {
                    const assignment = routeTracker.getRouteAssignment(route.routeId);
                    allRoutesData.push({
                        ...route,
                        status: assignment ? 'assigned' : 'available',
                        assignmentData: assignment
                    });
                });
            });
            
            // Calculate statistics
            const assignedRoutes = allRoutesData.filter(route => route.status === 'assigned');
            const availableRoutes = allRoutesData.filter(route => route.status === 'available');
            
            // Get unique units and calculate total tags
            const units = new Set();
            let totalTags = 0;
            
            assignedRoutes.forEach(route => {
                if (route.assignmentData) {
                    units.add(route.assignmentData.unit);
                }
            });
            
            // Calculate total assigned tags (flyers) for assigned routes only
            assignedRoutes.forEach(route => {
                totalTags += route.flyerCount;
            });
            
            // Update display
            document.getElementById('loginTotalRoutes').textContent = assignedRoutes.length;
            document.getElementById('loginTotalTags').textContent = totalTags.toLocaleString();
            document.getElementById('loginActiveUnits').textContent = units.size;
            document.getElementById('loginAvailableRoutes').textContent = availableRoutes.length;
        }
    </script>
</body>
</html>